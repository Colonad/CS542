{
  "run_info": {
    "phase": "6",
    "run_id": "2025-11-30_193908",
    "random_state": 0,
    "data_csv": "data/raw/usa_real_estate.csv",
    "data_hash": "sha256:2678a7d0a1054861464d0dbdf938c133ffd3e5c5f22c8065255bab87e9af0de4",
    "train_rows": 50000,
    "val_rows": 495,
    "test_rows": 4,
    "split_years": {
      "train_max": 2022,
      "val": 2023,
      "test_min": 2024
    },
    "feature_counts": {
      "numeric": 10,
      "categorical": 3
    },
    "date_window": {
      "min": "1901-01-01",
      "max": "2026-04-08"
    },
    "gpu_probe": {
      "ok": false,
      "note": "xgboost 3.0.5 GPU probe failed; modern recipe used=cpu | legacy recipe failed: [19:39:19] /home/conda/feedstock_root/build_artifacts/xgboost-split_1758007966380/work/src/c_api/../common/common.h:181: XGBoost version not compiled with GPU support.\nStack trace:\n  [bt] (0) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(dmlc::LogMessageFatal::~LogMessageFatal()+0x6e) [0x73d2268ce57e]\n  [bt] (1) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(xgboost::common::AssertGPUSupport()+0x3b) [0x73d2268ce81b]\n  [bt] (2) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(xgboost::gbm::GBTree::Configure(std::vector<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > const&)+0x1d1b) [0x73d226ca21fb]\n  [bt] (3) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(xgboost::LearnerConfiguration::Configure()+0xaa8) [0x73d226cf1b78]\n  [bt] (4) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(xgboost::LearnerImpl::UpdateOneIter(int, std::shared_ptr<xgboost::DMatrix>)+0x6b) [0x73d226ce872b]\n  [bt] (5) /home/angel/miniconda3/envs/CS542-Project/lib/libxgboost.so(XGBoosterUpdateOneIter+0x4f) [0x73d226838c1f]\n  [bt] (6) /home/angel/miniconda3/envs/CS542-Project/lib/python3.12/lib-dynload/../../libffi.so.8(+0x6d8a) [0x73d300830d8a]\n  [bt] (7) /home/angel/miniconda3/envs/CS542-Project/lib/python3.12/lib-dynload/../../libffi.so.8(+0x61cd) [0x73d3008301cd]\n  [bt] (8) /home/angel/miniconda3/envs/CS542-Project/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xcd) [0x73d30083091d]\n\n",
      "injected_params": {}
    },
    "cuml": {
      "requested": {
        "enabled": true,
        "ridge": false,
        "rf": true
      },
      "available": false,
      "version": null,
      "note": "cuML unavailable: No module named 'cuml'"
    },
    "dod": {
      "metrics_reported_on_test": true,
      "model_beats_baseline": true
    }
  },
  "target": {
    "name": "price",
    "log_transform": true
  },
  "baseline": {
    "val": {
      "MAE": 147367.0525252525,
      "RMSE": 276213.73591794726,
      "R2": 0.19397051529669607
    },
    "test": {
      "MAE": 257775.0,
      "RMSE": 296286.74877557385,
      "R2": -2.326402131931169
    }
  },
  "ridge": {
    "trials": [
      {
        "params": {
          "alpha": 1.0
        },
        "metrics_val": {
          "MAE": 124308.49255050505,
          "RMSE": 196413.6046161048,
          "R2": 0.5924287731441285
        },
        "smear_train": 1.1452671137412442,
        "device_used": "cpu(sklearn)"
      },
      {
        "params": {
          "alpha": 2.0
        },
        "metrics_val": {
          "MAE": 124454.87474747475,
          "RMSE": 196679.39273049502,
          "R2": 0.591324970962388
        },
        "smear_train": 1.1452587305437354,
        "device_used": "cpu(sklearn)"
      }
    ],
    "best_val": {
      "params": {
        "alpha": 1.0
      },
      "metrics_val": {
        "MAE": 124308.49255050505,
        "RMSE": 196413.6046161048,
        "R2": 0.5924287731441285
      },
      "smear_train": 1.1452671137412442,
      "device_used": "cpu(sklearn)"
    }
  },
  "rf": {
    "trials": [],
    "best_val": {
      "params": null,
      "metrics_val": null,
      "smear_train": NaN,
      "device_used": null
    }
  },
  "xgb": {
    "trials": [
      {
        "params": {
          "learning_rate": 0.05,
          "max_depth": 6,
          "n_estimators": 400,
          "subsample": 0.8,
          "colsample_bytree": 0.8,
          "random_state": 0,
          "objective": "reg:squarederror",
          "tree_method": "hist"
        },
        "metrics_val": {
          "MAE": 119027.08828914141,
          "RMSE": 180869.5828424639,
          "R2": 0.6543858947632599
        },
        "smear_train": 1.0888749287768735,
        "device_used": "cpu"
      }
    ],
    "best_val": {
      "params": {
        "learning_rate": 0.05,
        "max_depth": 6,
        "n_estimators": 400,
        "subsample": 0.8,
        "colsample_bytree": 0.8,
        "random_state": 0,
        "objective": "reg:squarederror",
        "tree_method": "hist"
      },
      "metrics_val": {
        "MAE": 119027.08828914141,
        "RMSE": 180869.5828424639,
        "R2": 0.6543858947632599
      },
      "device_used": "cpu",
      "smear_train": 1.0888749287768735
    }
  },
  "best_overall_on_val": {
    "family": "xgb",
    "metrics_val": {
      "MAE": 119027.08828914141,
      "RMSE": 180869.5828424639,
      "R2": 0.6543858947632599
    },
    "params": {
      "learning_rate": 0.05,
      "max_depth": 6,
      "n_estimators": 400,
      "subsample": 0.8,
      "colsample_bytree": 0.8,
      "random_state": 0,
      "objective": "reg:squarederror",
      "tree_method": "hist"
    }
  },
  "final": {
    "ridge": {
      "final_metrics_test": {
        "MAE": 201059.39453125,
        "RMSE": 266277.7571632751,
        "R2": -1.6867055601120167
      },
      "smear_trainval": 1.1285190756717385,
      "model_path": "data/outputs/models/phase6_ridge.pkl",
      "preds_path": "data/outputs/preds/test_preds_ridge.csv",
      "feature_importances_path": null,
      "final_model_params": {
        "alpha": 1.0,
        "copy_X": true,
        "fit_intercept": true,
        "max_iter": null,
        "positive": false,
        "random_state": 0,
        "solver": "auto",
        "tol": 0.0001
      },
      "device_used_final": "cpu(sklearn)"
    },
    "xgb": {
      "final_metrics_test": {
        "MAE": 156373.8671875,
        "RMSE": 176759.22923164765,
        "R2": -0.18389855862664728
      },
      "smear_trainval": 1.0885083618295603,
      "model_path": "data/outputs/models/phase6_xgb.pkl",
      "preds_path": "data/outputs/preds/test_preds_xgb.csv",
      "feature_importances_path": "data/outputs/models/feature_importances_xgb.csv",
      "final_model_params": {
        "objective": "reg:squarederror",
        "base_score": null,
        "booster": null,
        "callbacks": null,
        "colsample_bylevel": null,
        "colsample_bynode": null,
        "colsample_bytree": 0.8,
        "device": null,
        "early_stopping_rounds": null,
        "enable_categorical": false,
        "eval_metric": null,
        "feature_types": null,
        "feature_weights": null,
        "gamma": null,
        "grow_policy": null,
        "importance_type": null,
        "interaction_constraints": null,
        "learning_rate": 0.05,
        "max_bin": null,
        "max_cat_threshold": null,
        "max_cat_to_onehot": null,
        "max_delta_step": null,
        "max_depth": 6,
        "max_leaves": null,
        "min_child_weight": null,
        "missing": null,
        "monotone_constraints": null,
        "multi_strategy": null,
        "n_estimators": 400,
        "n_jobs": null,
        "num_parallel_tree": null,
        "random_state": 0,
        "reg_alpha": null,
        "reg_lambda": null,
        "sampling_method": null,
        "scale_pos_weight": null,
        "subsample": 0.8,
        "tree_method": "hist",
        "validate_parameters": null,
        "verbosity": null
      },
      "device_used_final": "cpu"
    }
  }
}